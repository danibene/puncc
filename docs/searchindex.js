Search.setIndex({"docnames": ["api", "calibration", "classification", "conformalization", "getting_started", "index", "metrics", "nonconformity_scores", "plotting", "prediction", "prediction_sets", "regression", "splitting", "theory_overview", "utils"], "filenames": ["api.rst", "calibration.rst", "classification.rst", "conformalization.rst", "getting_started.rst", "index.rst", "metrics.rst", "nonconformity_scores.rst", "plotting.rst", "prediction.rst", "prediction_sets.rst", "regression.rst", "splitting.rst", "theory_overview.rst", "utils.rst"], "titles": ["\ud83d\udcbb API", "Calibration", "\ud83d\udcca Classification", "Conformalization", "\ud83d\ude80 Quickstart", "Welcome to puncc\u2019s documentation!", "\ud83d\udccf Metrics", "Nonconformity scores", "\ud83d\uddbc\ufe0f Plotting", "Prediction", "Prediction sets", "\ud83d\udcc8 Regression", "Splitting", "\ud83d\udcc8 Theory overview", "Utils"], "terms": {"The": [0, 4, 13], "low": 0, "level": [0, 13], "offer": 0, "more": [0, 4, 13], "flexibl": 0, "defin": [0, 4, 5, 12], "conform": [0, 2, 5, 11], "predict": [0, 2, 5, 11], "wrapper": [0, 2, 4, 11], "let": [0, 4, 13], "sai": 0, "we": [0, 4, 13], "want": [0, 4], "fit": [0, 2, 4, 11, 12, 13], "neural": 0, "network": 0, "interv": [0, 4, 11], "estim": [0, 4, 5, 13], "cross": 0, "valid": 0, "plan": 0, "experi": [0, 13], "differ": [0, 4, 13], "user": [0, 13], "nonconform": [0, 4, 13], "score": [0, 4, 13], "In": [0, 4, 13], "case": [0, 13], "other": [0, 4], "can": [0, 4, 5, 13], "fulli": 0, "construct": [0, 4, 13], "us": [0, 4, 5, 13], "propos": 0, "paradigm": 0, "It": [0, 5, 13], "boil": [0, 13], "down": [0, 13], "assembl": 0, "deel": [0, 4, 5], "puncc": [0, 2, 4, 11], "model": [0, 2, 5, 11, 13], "an": [0, 4, 5, 13], "A": [0, 13], "strategi": 0, "assign": [0, 12], "data": [0, 4, 5, 12, 13], "set": [0, 4, 5, 12], "induct": [0, 4], "cp": [0, 4, 13], "split": [0, 4], "util": [0, 4], "i": [0, 4, 5, 13], "canva": 0, "procedur": [0, 4, 13], "object": [0, 2, 11], "instanc": 0, "explain": 0, "later": [0, 4], "import": [0, 4], "from": [0, 2, 4, 11, 13], "sklearn": [0, 4], "linear_model": [0, 4], "basepredictor": [0, 4], "basecalibr": 0, "kfoldsplitt": 0, "regress": [0, 5], "linear": [0, 4], "linearregress": [0, 4], "definit": 0, "thi": [0, 2, 4, 11, 13], "my_predictor": 0, "built": 0, "given": [0, 13], "build": [0, 13], "custom": 0, "function": [0, 13], "altern": [0, 5], "sever": [0, 4, 13], "readi": 0, "nonconf": 0, "ar": [0, 2, 4, 5, 11, 13], "provid": [0, 4, 5], "nonconformity_scor": 0, "def": 0, "my_ncf": 0, "y_pred": [0, 4], "y_true": 0, "return": [0, 4], "np": [0, 4], "ab": [0, 13], "prediction_set": 0, "my_psf": 0, "nonconf_scores_quantil": 0, "y_lower": 0, "y_upper": 0, "my_calibr": 0, "nonconf_score_func": 0, "pred_set_func": 0, "k": [0, 13], "fold": [0, 13], "produc": [0, 13], "20": 0, "kfold_splitt": 0, "random_st": 0, "42": [0, 4], "conformal_predictor": 0, "implement": [0, 2, 4, 11], "two": [0, 4, 13], "method": [0, 2, 4, 11, 13], "comput": [0, 4, 13], "accordingli": 0, "x_train": [0, 4], "y_train": [0, 4], "full": 0, "train": [0, 4, 13], "dataset": [0, 13], "pass": [0, 2, 11], "argument": [0, 2, 4, 11], "base": [0, 11, 13], "And": 0, "new": [0, 4, 13], "sampl": [0, 4, 13], "point": [0, 4, 11, 13], "y_pred_low": [0, 4], "y_pred_upp": [0, 4], "w": [0, 4, 13], "r": [0, 4, 13], "t": [0, 4, 13], "chosen": [0, 4], "error": [0, 5, 13], "signific": [0, 13], "alpha": [0, 4, 5, 13], "coverag": [0, 4, 13], "target": [0, 4, 13], "1": [0, 4, 13], "90": [0, 4], "x_new": 0, "code": [0, 4], "snippet": 0, "previou": 0, "cvplu": 0, "like": [0, 13], "randomli": 0, "gener": [0, 4, 5, 13], "below": [0, 4, 13], "make_regress": 0, "model_select": 0, "train_test_split": 0, "plot": [0, 4, 5], "plot_prediction_interv": 0, "metric": [0, 4, 5], "random": [0, 4, 13], "problem": [0, 4, 5, 13], "x": [0, 13], "y": [0, 13], "n_sampl": 0, "1000": 0, "n_featur": 0, "4": 0, "n_inform": 0, "2": [0, 4, 13], "0": [0, 4, 13], "shuffl": 0, "fals": [0, 4], "test": [0, 4, 13], "x_test": [0, 4], "y_test": [0, 4], "test_siz": 0, "empir": [0, 4, 13], "margin": [0, 4, 13], "averag": [0, 4, 13], "width": [0, 4, 13], "regression_mean_coverag": [0, 4], "regression_sharp": [0, 4], "print": [0, 4], "f": [0, 4, 13], "round": [0, 4], "figur": 0, "band": 0, "sort_x": 0, "true": [0, 4, 5], "size": [0, 4, 13], "10": [0, 4, 13], "6": 0, "loc": 0, "upper": [0, 13], "left": [0, 13], "dualpredictor": 0, "class": [0, 4], "ml": [0, 2, 4, 11], "dl": [0, 2, 4, 11], "aim": 0, "expos": 0, "standard": [0, 4], "interfac": 0, "guarante": [0, 4, 5, 13], "complianc": [0, 2, 11], "framework": [0, 13], "have": [0, 13], "take": 0, "iter": 0, "collect": [0, 5], "ndarrai": 0, "tensor": 0, "ani": [0, 5, 13], "addit": [0, 4, 13], "configur": 0, "underli": [0, 13], "e": [0, 5, 13], "g": [0, 13], "seed": 0, "batch": 0, "copi": 0, "exampl": [0, 4, 13], "ha": [0, 4, 13], "deepcopi": 0, "constructor": [0, 2, 4, 11], "wrap": [0, 4], "flag": 0, "inform": [0, 4, 13], "alreadi": [0, 4], "compil": [0, 4], "keyword": 0, "need": [0, 2, 4, 11, 13], "kera": [0, 2, 4, 11], "conceptu": 0, "similar": 0, "list": [0, 2, 11], "kwarg": 0, "Such": [0, 2, 4, 11], "when": [0, 13], "reli": [0, 13], "lower": [0, 13], "quantil": 0, "cqr": 0, "note": [0, 4, 13], "output": [0, 4, 5], "coupl": 0, "where": [0, 13], "first": [0, 5, 13], "resp": 0, "second": 0, "axi": 0, "associ": [0, 4, 13], "specif": [0, 13], "meanvarpredictor": 0, "subclass": 0, "one": [0, 4, 13], "absolut": [0, 13], "former": 0, "These": 0, "three": [0, 4], "cover": [0, 4, 5], "plenti": 0, "But": 0, "you": [0, 4, 5], "special": 0, "even": 0, "creat": [0, 4, 5], "scratch": 0, "here": [0, 4], "situat": 0, "your": 0, "own": 0, "classif": [0, 5], "randomforestclassifi": 0, "rap": [0, 4], "classifi": [0, 4], "requir": [0, 5, 13], "probabl": [0, 13], "each": [0, 2, 4, 11, 13], "onli": [0, 4], "most": [0, 13], "which": [0, 4, 13], "redefin": 0, "call": [0, 13], "ensembl": 0, "rf": 0, "rf_model": 0, "n_estim": 0, "100": [0, 4], "forest": 0, "its": 0, "logit": 0, "make": [0, 4, 5], "sure": [0, 5], "over": [0, 13], "becaus": 0, "doe": [0, 13], "otherwis": [0, 13], "enough": 0, "softmax": [0, 4], "rfpredictor": 0, "self": 0, "predict_proba": 0, "newli": 0, "rf_predictor": 0, "structur": 0, "At": [0, 13], "decid": 0, "Then": [0, 13], "mean": [0, 13], "deviat": [0, 13], "enabl": 0, "For": [0, 4, 13], "constant": [0, 13], "mad": 0, "constant_interv": 0, "respect": [0, 13], "them": [0, 13], "motiv": 0, "criteria": 0, "avail": 0, "resourc": 0, "If": [0, 13], "qualiti": 0, "abund": 0, "disjoint": 0, "subset": [0, 4], "d_": [0, 4, 13], "calib": [0, 4], "scarc": 0, "prefer": 0, "consum": 0, "agnost": [0, 13], "datafram": 0, "randomsplitt": 0, "equal": 0, "identifi": 0, "leav": [0, 13], "out": [0, 13], "additionnali": 0, "obtain": [0, 4, 13], "asign": 0, "idsplitt": 0, "current": [2, 5, 11], "page": [2, 4, 11, 13], "modul": [2, 4, 11], "api": [2, 4, 5, 11], "ensur": [2, 11], "variou": [2, 4, 11, 13], "librari": [2, 4, 5, 11], "scikit": [2, 4, 11], "learn": [2, 4, 11, 13], "": [4, 13], "consid": 4, "simpl": 4, "evalu": 4, "uncertainti": [4, 5], "contain": [4, 13], "about": 4, "442": 4, "patient": 4, "goal": 4, "physiolog": 4, "variabl": [4, 13], "quantit": 4, "measur": [4, 13], "diseas": 4, "progress": 4, "year": 4, "There": 4, "ten": 4, "featur": 4, "correspond": 4, "ag": 4, "sex": 4, "bodi": 4, "mass": 4, "index": 4, "blood": 4, "pressur": 4, "six": 4, "serum": 4, "dure": [4, 13], "check": 4, "offici": 4, "document": 4, "load": 4, "diabetes_x": 4, "diabetes_i": 4, "load_diabet": 4, "return_x_i": 4, "shape": 4, "all": [4, 13], "our": [4, 13], "captur": 4, "link": [4, 13], "between": 4, "evolut": 4, "numpi": 4, "bmi": 4, "newaxi": 4, "By": 4, "indep": 4, "ident": 4, "distribut": [4, 13], "d": [4, 5, 13], "great": 4, "fullfil": 4, "prerequisit": 4, "appli": 4, "next": 4, "step": [4, 13], "splite": 4, "cal": 4, "calibr": [4, 12, 13], "rigor": [4, 5, 13], "probabilist": 4, "hold": [4, 13], "follow": [4, 13], "aforement": 4, "x_fit": 4, "x_calib": 4, "y_fit": 4, "y_calib": 4, "lin_reg_model": 4, "possibl": 4, "xgboost": 4, "support": 4, "checkout": 4, "predictor": [4, 13], "earlier": 4, "lin_reg_predictor": 4, "throught": 4, "splitcp": 4, "present": [4, 13], "instanci": 4, "around": 4, "befor": 4, "initi": 4, "save": 4, "time": [4, 13], "split_cp": 4, "residu": [4, 13], "95": [4, 13], "211": 4, "38": 4, "tool": 4, "visual": 4, "whether": 4, "observ": [4, 13], "tackl": 4, "classic": 4, "handwritten": 4, "digit": 4, "through": [4, 13], "larg": 4, "number": 4, "28": 4, "imag": 4, "label": 4, "As": [4, 13], "process": [4, 13], "post": [4, 13], "applic": [4, 13], "preprocess": 4, "tensorflow": 4, "to_categor": 4, "databas": 4, "load_data": 4, "reshap": 4, "len": 4, "astyp": 4, "float32": 4, "255": 4, "50000": 4, "One": 4, "hot": 4, "encod": 4, "y_fit_cat": 4, "y_calib_cat": 4, "y_test_cat": 4, "convnet": 4, "layer": 4, "set_se": 4, "compos": 4, "convolut": 4, "pool": 4, "dens": 4, "nn_model": 4, "sequenti": 4, "input": 4, "conv2d": 4, "16": 4, "kernel_s": 4, "3": [4, 13], "activ": 4, "relu": 4, "maxpooling2d": 4, "pool_siz": 4, "32": [4, 13], "flatten": 4, "abov": [4, 13], "is_train": 4, "config": 4, "detail": 4, "gather": 4, "dictionnari": 4, "compile_kwarg": 4, "optim": 4, "adam": 4, "loss": 4, "categorical_crossentropi": 4, "accuraci": 4, "class_predictor": 4, "algorithm": [4, 5, 13], "hyparamet": 4, "lambda": 4, "k_": 4, "reg": 4, "encourag": 4, "smaller": 4, "To": 4, "start": 4, "off": 4, "gentli": 4, "ignor": 4, "regular": 4, "term": 4, "simpli": [4, 13], "turn": 4, "ap": 4, "aps_cp": 4, "lambd": 4, "fit_kwarg": 4, "epoch": 4, "batch_siz": 4, "256": 4, "validation_split": 4, "verbos": 4, "set_pr": 4, "matplotlib": 4, "pyplot": 4, "plt": 4, "18": 4, "imshow": 4, "titl": 4, "argmax": 4, "n": [4, 13], "mean_coverag": 4, "classification_mean_coverag": 4, "mean_siz": 4, "classification_mean_s": 4, "2f": 4, "03": 4, "p": [5, 13], "redict": 5, "un": 5, "certainti": 5, "c": [5, 13], "alibr": 5, "onform": 5, "open": 5, "sourc": [5, 13], "python": 5, "integr": 5, "state": 5, "art": 5, "relat": 5, "techniqu": 5, "under": 5, "exchang": [5, 13], "within": [5, 13], "clone": 5, "repo": 5, "git": 5, "http": [5, 13], "github": [5, 13], "com": [5, 13], "ai": 5, "pip": 5, "interact": 5, "makefil": 5, "automat": 5, "virtual": 5, "environ": 5, "env": 5, "final": 5, "jupyt": 5, "notebook": 5, "add": 5, "m": [5, 13], "ipykernel": 5, "name": [5, 13], "dev": 5, "prepar": 5, "quickstart": 5, "theori": 5, "overview": 5, "helper": 12, "how": 12, "machin": 13, "choos": 13, "right": 13, "approach": 13, "access": 13, "via": 13, "despit": 13, "best": 13, "effort": 13, "encount": 13, "some": 13, "could": 13, "stem": 13, "caus": 13, "typic": 13, "categor": 13, "type": 13, "aleator": 13, "also": 13, "known": 13, "statist": 13, "irreduc": 13, "due": 13, "intrins": 13, "phenomenon": 13, "being": 13, "epistem": 13, "systemat": 13, "reduc": 13, "better": 13, "depend": 13, "field": 13, "major": 13, "impact": 13, "perform": 13, "safeti": 13, "free": 13, "non": 13, "asymptot": 13, "rate": 13, "x_i": 13, "y_i": 13, "_": 13, "x_": 13, "y_": 13, "joint": 13, "mathbb": 13, "xy": 13, "cdot": 13, "so": 13, "big": 13, "geq": 13, "mani": 13, "valu": 13, "frequenc": 13, "least": 13, "inequ": 13, "finit": 13, "noteworthi": 13, "therefor": 13, "undercov": 13, "condition": 13, "region": 13, "space": 13, "act": 13, "attain": 13, "exist": 13, "after": 13, "black": 13, "box": 13, "yield": 13, "common": 13, "literatur": 13, "angelopoulo": 13, "bate": 13, "angelopoulos2022": 13, "hand": 13, "introduct": 13, "awesom": 13, "ressourc": 13, "n_": 13, "sim": 13, "p_": 13, "maximum": 13, "papadopoulos2002": 13, "lei2018": 13, "widehat": 13, "summar": 13, "pick": 13, "bar": 13, "r_i": 13, "dot": 13, "cardin": 13, "delta_": 13, "frac": 13, "th": 13, "center": 13, "been": 13, "combin": 13, "hereaft": 13, "papadopoulos2008": 13, "scale": 13, "sigma": 13, "dispers": 13, "usual": 13, "again": 13, "heteroskedasc": 13, "improv": 13, "condit": 13, "price": 13, "higher": 13, "cost": 13, "proper": 13, "extend": 13, "q": 13, "text": 13, "max": 13, "alpha_": 13, "lo": 13, "hi": 13, "would": 13, "05": 13, "evenli": 13, "do": 13, "romano2019": 13, "correct": 13, "misspecifi": 13, "bad": 13, "approxim": 13, "well": 13, "get": 13, "small": 13, "were": 13, "strong": 13, "theoret": 13, "properti": 13, "inherit": 13, "accur": 13, "loo": 13, "scheme": 13, "shown": 13, "partit": 13, "principl": 13, "barber2021": 13, "introduc": 13, "jp": 13, "With": 13, "dedic": 13, "goe": 13, "disjointli": 13, "s_1": 13, "s_2": 13, "s_k": 13, "belong": 13, "s_": 13, "store": 13, "memori": 13, "indic": 13, "wa": 13, "except": 13, "those": 13, "version": 13, "infer": 13, "bound": 13, "l": 13, "lfloor": 13, "rfloor": 13, "smallest": 13, "u": 13, "lceil": 13, "rceil": 13, "tbc": 13, "2021": 13, "gentl": 13, "arxiv": 13, "preprint": 13, "2107": 13, "07511": 13, "org": 13, "barber": 13, "cand": 13, "j": 13, "ramda": 13, "tibshirani": 13, "ann": 13, "49": 13, "486": 13, "507": 13, "februari": 13, "1905": 13, "02928": 13, "lei": 13, "sell": 13, "rinaldo": 13, "wasserman": 13, "2018": 13, "journal": 13, "american": 13, "113": 13, "523": 13, "pp": 13, "1094": 13, "1111": 13, "1604": 13, "04173": 13, "papadopoulo": 13, "h": 13, "proedrou": 13, "vovk": 13, "v": 13, "gammerman": 13, "2002": 13, "confid": 13, "proceed": 13, "ecml": 13, "springer": 13, "chapter": 13, "1007": 13, "540": 13, "36755": 13, "1_29": 13, "2008": 13, "normal": 13, "iast": 13, "intern": 13, "confer": 13, "artifici": 13, "intellig": 13, "aia": 13, "64": 13, "69": 13, "romano": 13, "patterson": 13, "2019": 13, "neurip": 13, "03222": 13}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"api": 0, "tabl": [0, 4], "content": [0, 4, 5], "": [0, 5], "modul": 0, "overview": [0, 13], "conformalpredictor": 0, "predictor": 0, "calibr": [0, 1], "splitter": 0, "classif": [2, 4, 13], "conform": [3, 4, 13], "quickstart": 4, "regress": [4, 11, 13], "diabet": 4, "dataset": 4, "predict": [4, 9, 10, 13], "model": 4, "mnist": 4, "welcom": 5, "puncc": 5, "document": 5, "instal": 5, "For": 5, "user": 5, "developp": 5, "metric": 6, "nonconform": 7, "score": 7, "plot": 8, "set": [10, 13], "split": [12, 13], "theori": 13, "uncertainti": 13, "quantif": 13, "induct": 13, "local": 13, "adapt": 13, "quantil": 13, "cqr": 13, "cross": 13, "valid": 13, "cv": 13, "jackknif": 13, "ensembl": 13, "batch": 13, "interv": 13, "enbpi": 13, "ap": 13, "regular": 13, "rap": 13, "refer": 13, "util": 14}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 57}, "alltitles": {"\ud83d\udcbb API": [[0, "api"]], "Table of Contents": [[0, "table-of-contents"], [4, "table-of-contents"]], "API\u2019s Modules": [[0, "api-s-modules"]], "Overview": [[0, "overview"]], "ConformalPredictor": [[0, "conformalpredictor"]], "Predictor": [[0, "predictor"]], "Calibrator": [[0, "calibrator"]], "Splitter": [[0, "splitter"]], "Calibration": [[1, "calibration"]], "\ud83d\udcca Classification": [[2, "classification"]], "Conformalization": [[3, "conformalization"]], "\ud83d\ude80 Quickstart": [[4, "quickstart"]], "\ud83d\udcc8 Conformal Regression": [[4, "conformal-regression"]], "\ud83d\udcbe Diabetes Dataset": [[4, "diabetes-dataset"]], "\ud83d\udd2e Prediction model": [[4, "prediction-model"]], "\u2699\ufe0f Conformal prediction": [[4, "conformal-prediction"], [4, "id2"]], "\ud83d\udcca Conformal Classification": [[4, "conformal-classification"]], "\ud83d\udcbe MNIST Dataset": [[4, "mnist-dataset"]], "\ud83d\udd2e Prediction Model": [[4, "id1"]], "Welcome to puncc\u2019s documentation!": [[5, "welcome-to-puncc-s-documentation"]], "Installation": [[5, "installation"]], "For users": [[5, "for-users"]], "For developpers": [[5, "for-developpers"]], "Contents": [[5, null]], "\ud83d\udccf Metrics": [[6, "metrics"]], "Nonconformity scores": [[7, "nonconformity-scores"]], "\ud83d\uddbc\ufe0f Plotting": [[8, "plotting"]], "Prediction": [[9, "prediction"]], "Prediction sets": [[10, "prediction-sets"]], "\ud83d\udcc8 Regression": [[11, "regression"]], "Splitting": [[12, "splitting"]], "\ud83d\udcc8 Theory overview": [[13, "theory-overview"]], "Uncertainty Quantification": [[13, "uncertainty-quantification"]], "Conformal Prediction": [[13, "conformal-prediction"]], "Conformal Regression": [[13, "conformal-regression"]], "Split (inductive) Conformal": [[13, "split-inductive-conformal"]], "Locally Adaptive Conformal Regression": [[13, "locally-adaptive-conformal-regression"]], "Conformalized Quantile Regression (CQR)": [[13, "conformalized-quantile-regression-cqr"]], "Cross-validation+ (CV+), Jackknife+": [[13, "cross-validation-cv-jackknife"]], "Ensemble Batch Prediction Intervals (EnbPI)": [[13, "ensemble-batch-prediction-intervals-enbpi"]], "Conformal Classification": [[13, "conformal-classification"]], "Adaptive Prediction Sets (APS)": [[13, "adaptive-prediction-sets-aps"]], "Regularized Adaptive Prediction Sets (RAPS)": [[13, "regularized-adaptive-prediction-sets-raps"]], "References": [[13, "references"]], "Utils": [[14, "utils"]]}, "indexentries": {}})